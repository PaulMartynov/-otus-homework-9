!function(){"use strict";function e(e){e.setAttribute("class","alive"),e.setAttribute("style","background-color:black; height:15px; width:15px;")}function t(e){e.setAttribute("class","dead"),e.setAttribute("style","background-color:#FFFFFF; height:15px; width:15px;")}function r(r){var n=document.createElement("td");n.setAttribute("class","dead"),n.setAttribute("style","background-color:#FFFFFF; height:15px; width:15px;"),n.addEventListener("click",(function(){!function(r){"dead"===r.getAttribute("class")?e(r):t(r)}(n)})),r.appendChild(n)}function n(e,t){for(var n=document.createElement("tr"),i=0;i<t;i+=1)r(n);e.appendChild(n)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){var n=e[r];if(void 0===n)return 0;var i=n[t];return void 0===i?0:"alive"===i.getAttribute("class")||"doomed"===i.getAttribute("class")?1:0}function o(e,t,r){var n=function(e,t,r){for(var n=0,i=t-1;i<=t+1;i+=1)n+=a(e,i,r-1),n+=a(e,i,r+1);return(n+=a(e,t-1,r))+a(e,t+1,r)}(e,t,r);return 3===n?1:(n>3||n<2)&&"alive"===e[r][t].getAttribute("class")?0:2}function u(e,t){try{for(var r=0;r<e.length;r+=1)for(var n=0;n<e[r].length;n+=1)if(e[r][n].getAttribute("class")!==t[r][n])return!1}catch(e){return!1}return!0}var l=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.gameField=e,this.startBtn=t,this.gameSpeed=3e3-n,this.generations=[]}var n,a;return n=r,(a=[{key:"setGameSpeed",value:function(e){this.gameSpeed=3e3-e,this.gameIsRunning&&(this.stop(),this.start())}},{key:"addNewGeneration",value:function(e){for(var t=[],r=0;r<e.length;r+=1){for(var n=[],i=0;i<e[r].length;i+=1)n.push(e[r][i].getAttribute("class"));t.unshift(n)}this.generations.unshift(t),this.generations.length>2&&this.generations.pop()}},{key:"stop",value:function(){this.gameIsRunning=!1,this.startBtn.setAttribute("value","Start game"),clearInterval(this.timer)}},{key:"run",value:function(){var r,n=function(e){for(var t=[],r=e.querySelectorAll("tr"),n=0;n<r.length;n+=1)t.push(r[n].querySelectorAll("td"));return t}(this.gameField);this.addNewGeneration(n),this.gameField.querySelectorAll(".doomed").forEach((function(e){t(e)})),function(t){for(var r=[],n=[],i=0;i<t.length;i+=1)for(var a=0;a<t[i].length;a+=1)1===o(t,a,i)?r.push(t[i][a]):0===o(t,a,i)&&n.push(t[i][a]);n.forEach((function(e){var t;(t=e).setAttribute("class","doomed"),t.setAttribute("style","background-color:blue; height:15px; width:15px;")})),r.forEach((function(t){e(t)}))}(n),(r=this.gameField).querySelectorAll(".alive").length>0||r.querySelectorAll(".doomed").length>0?function(e,t){for(var r=0;r<t.length;r+=1)if(!u(e,t[r]))return!1;return!0}(n,this.generations)&&(alert("Game repeating of some of previous generations"),this.stop()):(alert("All cells is dead"),this.stop())}},{key:"start",value:function(){var e=this;this.gameIsRunning=!0,this.startBtn.setAttribute("value","Stop game"),this.timer=setInterval((function(){e.run()}),this.gameSpeed)}}])&&i(n.prototype,a),r}(),s=document.querySelector("#Ox"),c=document.querySelector("#Oy"),f=document.querySelector("#speed"),h=document.querySelector("#start"),d=document.querySelector("#game_field");if(s&&c&&d&&f&&h){!function(e,t,r){for(var i=0;i<r;i+=1)n(e,t);e.setAttribute("border","1")}(d,Number(s.value),Number(c.value));var v=new l(d,h,Number(f.value));s.addEventListener("click",(function(){!function(e,t){var n=e.querySelectorAll("tr");if(0!==n.length)for(var i=0;i<n.length;i+=1){var a=n[i].querySelectorAll("td"),o=t-a.length;if(o>0)for(var u=0;u<o;u+=1)r(n[i]);else if(o<0)for(var l=0;l>o;l-=1)a[a.length-1].remove(),a=n[i].querySelectorAll("td")}}(d,Number(s.value))})),c.addEventListener("click",(function(){!function(e,t){var r=e.querySelectorAll("tr");if(0!==r.length){var i=t-r.length;if(i>0)for(var a=0;a<i;a+=1)n(e,r[0].querySelectorAll("td").length);else if(i<0)for(var o=0;o>i;o-=1)r[r.length-1].remove(),r=e.querySelectorAll("tr")}}(d,Number(c.value))})),f.addEventListener("mouseup",(function(){v.setGameSpeed(Number(f.value))})),h.addEventListener("click",(function(){v.gameIsRunning?v.stop():v.start()}))}}();